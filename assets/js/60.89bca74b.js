(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{641:function(t,s,a){"use strict";a.r(s);var n=a(17),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"_1-有什么更新"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-有什么更新"}},[t._v("#")]),t._v(" 1. 有什么更新")]),t._v(" "),a("p",[a("strong",[t._v("（1）监测机制的改变")])]),t._v(" "),a("ul",[a("li",[t._v("3.0 将带来基于代理 Proxy的 observer 实现，提供全语言覆盖的反应性跟踪。")]),t._v(" "),a("li",[t._v("使用Proxy代替defineProperty实现响应式")]),t._v(" "),a("li",[t._v("检测属性的添加和删除；")]),t._v(" "),a("li",[t._v("检测数组索引和长度的变更；")]),t._v(" "),a("li",[t._v("支持 Map、Set、WeakMap 和 WeakSet。")])]),t._v(" "),a("p",[a("strong",[t._v("（2）模板")])]),t._v(" "),a("ul",[a("li",[t._v("作用域插槽，2.x 的机制导致作用域插槽变了，父组件会重新渲染，而 3.0 把作用域插槽改成了函数的方式，这样只会影响子组件的重新渲染，提升了渲染的性能。")]),t._v(" "),a("li",[t._v("render 函数方面，方便习惯直接使用 api 来生成 vdom 。")])]),t._v(" "),a("p",[a("strong",[t._v("（3）对象式的组件声明方式")])]),t._v(" "),a("ul",[a("li",[t._v("2.x 中的组件是通过声明的方式传入一系列 option，和 TS 的结合需要通过一些装饰器的方式来做，能实现功能较麻烦。")]),t._v(" "),a("li",[t._v("3.0 修改组件声明方式，改成类式的写法拥抱TS。")])]),t._v(" "),a("p",[a("strong",[t._v("（4）其它方面的更改")])]),t._v(" "),a("ul",[a("li",[t._v("支持自定义渲染器，从而使得 weex 可以通过自定义渲染器的方式来扩展，而不是直接 fork 源码来改的方式。")]),t._v(" "),a("li",[t._v("支持 Fragment（多个根节点）和 Protal（在 dom 其他部分渲染组建内容）组件，针对一些特殊的场景做了处理。")]),t._v(" "),a("li",[t._v("基于 tree shaking 优化，提供了更多的内置功能。重写虚拟DOM的实现和Tree-Shaking")]),t._v(" "),a("li",[t._v("性能的提升：打包大小减少41%、初次渲染快55%，更新渲染133%、内存减少54%")])]),t._v(" "),a("ul",[a("li",[t._v("Composition API（组合API）\n"),a("ul",[a("li",[t._v("setup配置")]),t._v(" "),a("li",[t._v("ref与reactive")]),t._v(" "),a("li",[t._v("watch与watchEffect")]),t._v(" "),a("li",[t._v("provide与inject")])])]),t._v(" "),a("li",[t._v("新的内置组件\n"),a("ul",[a("li",[t._v("Fragment")]),t._v(" "),a("li",[t._v("Teleport")]),t._v(" "),a("li",[t._v("Suspense")])])]),t._v(" "),a("li",[t._v("其他改变\n"),a("ul",[a("li",[t._v("新的生命周期钩子")]),t._v(" "),a("li",[t._v("data选项应始终被声明为一个函数")]),t._v(" "),a("li",[t._v("移除keyCode支持作为v-on的修饰符")])])])]),t._v(" "),a("h1",{attrs:{id:"_2-创建vue3工程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-创建vue3工程"}},[t._v("#")]),t._v(" 2. 创建Vue3工程")]),t._v(" "),a("p",[t._v("第一种方式：使用脚手架vue-cli创建")]),t._v(" "),a("ul",[a("li",[t._v("选择vue3版本脚手架即可，其他方式和vue2相同")])]),t._v(" "),a("p",[t._v("第二种方式：使用vite创建")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("官方文档：https://v3.cn.vuejs.org/guide/installation.html#vite")])]),t._v(" "),a("li",[a("p",[t._v("vite官网：https://vitejs.cn")]),t._v(" "),a("ul",[a("li",[t._v("vite是新一代前端构建工具（之前使用webpack）")])]),t._v(" "),a("p",[a("img",{attrs:{src:"img/vite.png",alt:"image-20220125172225678"}})]),t._v(" "),a("ul",[a("li",[t._v("优势如下：\n"),a("ul",[a("li",[t._v("开发环境中，无需打包操作，可快速的冷启动")]),t._v(" "),a("li",[t._v("轻量快速的热重载（HMR）")]),t._v(" "),a("li",[t._v("真正的按需编译，不再等待整个应用编译完成")]),t._v(" "),a("li",[t._v("动态的引用和代码分割，使得启动更快")])])])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 创建工程")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" init vite-app "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("project-name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 进入工程目录")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("project-name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 安装依赖")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 运行，发现启动更快了")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run dev\n")])])])])]),t._v(" "),a("h2",{attrs:{id:"_3-vue3文件分析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-vue3文件分析"}},[t._v("#")]),t._v(" 3. vue3文件分析")]),t._v(" "),a("h3",{attrs:{id:"main-js"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#main-js"}},[t._v("#")]),t._v(" main.js")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 引入的不再是Vue构造函数（构造函数需要new一下），引入的是一个名为createApp的工厂函数（直接调用）")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" createApp "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vue'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" App "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./App/vue'")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createApp")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("App"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mount")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'#app'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 上述代码类似于：")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" app "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createApp")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("App"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\napp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mount")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'#app'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("ul",[a("li",[t._v("创建应用实例对象——app（类似于之前vue2中的vm，但app比vm更“”轻），不信就console.log(app)看一看")]),t._v(" "),a("li",[t._v("会发现app身上挂载的属性和方法变少了")]),t._v(" "),a("li",[t._v("配置vue.config.js取消语法检查")]),t._v(" "),a("li",[t._v("vue3组件中可以没有根标签")])]),t._v(" "),a("h2",{attrs:{id:"_4-defineproperty-proxy"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-defineproperty-proxy"}},[t._v("#")]),t._v(" 4. defineProperty && proxy")]),t._v(" "),a("h3",{attrs:{id:"_4-1-区别"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-区别"}},[t._v("#")]),t._v(" 4.1 区别")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 模拟实现")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" person "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'张三'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("age")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" p "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("defineProperty")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("p"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'name'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" person"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'有人修改了name属性，我发现啦，我要去更新页面了~~'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        person"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" value\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("defineProperty问题：")]),t._v(" "),a("ul",[a("li",[t._v("添加或删除对象的属性时检测不到。只能通过"),a("code",[t._v("$set")]),t._v(" 来调用"),a("code",[t._v("Object.defineProperty()")]),t._v("处理。")]),t._v(" "),a("li",[t._v("无法监控到数组下标和长度的变化。")])]),t._v(" "),a("p",[t._v("0bject.defineProperty 会改变原始数据，Proxy 是创建对象的虚拟表示，提供 set 、get 和 deleteProperty等，这些处理器可在访问或修改原始对象上的属性时进行拦截，作用为：用于定义基本操作的自定义行为（如属性查找，赋值，枚举，函数调用等）。相对于"),a("code",[t._v("Object.defineProperty()")]),t._v("：")]),t._v(" "),a("ul",[a("li",[t._v("Proxy 直接代理整个对象而非对象属性，只做一层代理就可以监听同级结构所有属性变化，包括新增属性和删除属性。")]),t._v(" "),a("li",[t._v("全方位监听数组的变化。")]),t._v(" "),a("li",[t._v("支持 Map，Set，WeakMap 和 WeakSet。")])]),t._v(" "),a("p",[t._v("Proxy 与2的实现原理相同∶")]),t._v(" "),a("ul",[a("li",[t._v("get 收集依赖")]),t._v(" "),a("li",[t._v("Set、delete 等触发依赖")]),t._v(" "),a("li",[t._v("对于集合类型，就是对集合对象的方法做一层包装：原方法执行后执行依赖相关的收集或触发逻辑。")])]),t._v(" "),a("h3",{attrs:{id:"_4-2-实现proxy代理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-实现proxy代理"}},[t._v("#")]),t._v(" 4.2 实现proxy代理")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 模拟实现")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" person "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'张三'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("age")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" p "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Proxy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("person"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("propName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("有人读取了p身上的")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("propName"),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("属性")]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" Reflect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("propName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("propName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("有人修改了p身上的")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("propName"),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("属性，我要去更新界面啦~~")]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        Reflect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("propName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("deleteProperty")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("propName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("有人删除了p身上的")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("propName"),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("属性，我要去更新界面啦~~")]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" Reflect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("deleteProperty")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("propName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("ul",[a("li",[t._v("Reflect：对被代理对象属性进行操作\n"),a("ul",[a("li",[t._v("使用defineProperty不容易捕获错误，需要写很多的try catch")]),t._v(" "),a("li",[t._v("使用Reflect.defineProperty容易捕获错误")]),t._v(" "),a("li",[t._v("MDN文档中描述的Proxy与Reflect：\n"),a("ul",[a("li",[t._v("Proxy：https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy")]),t._v(" "),a("li",[t._v("Reflect：https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Reflect")])])])])])]),t._v(" "),a("h3",{attrs:{id:"_4-3-reactive-ref"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-reactive-ref"}},[t._v("#")]),t._v(" 4.3 reactive && ref")]),t._v(" "),a("ul",[a("li",[t._v("从定义数据角度对比：\n"),a("ul",[a("li",[t._v("ref定义基本类型数据")]),t._v(" "),a("li",[t._v("reactive定义对象（或数组）类型数据")]),t._v(" "),a("li",[t._v("备注：ref也可以用来定义对象（或数组）类型数据，它内部会自动通过"),a("code",[t._v("reactive")]),t._v("转为代理对象")])])]),t._v(" "),a("li",[t._v("从原理角度对比：\n"),a("ul",[a("li",[t._v("ref通过"),a("code",[t._v("Object.defineProperty()")]),t._v("的"),a("code",[t._v("get")]),t._v("与"),a("code",[t._v("set")]),t._v("实现")]),t._v(" "),a("li",[t._v("reactive通过Proxy实现，并通过Reflect操作源对象内部的数据")])])]),t._v(" "),a("li",[t._v("从使用角度对比：\n"),a("ul",[a("li",[t._v("ref：操作数据需要"),a("code",[t._v(".value")]),t._v("，模板中直接读取不需要")]),t._v(" "),a("li",[t._v("reactive定义的数据：均不需要"),a("code",[t._v(".value")]),t._v("，语义化更推荐使用")])])])]),t._v(" "),a("h2",{attrs:{id:"_5-vue-3-0-中的-vue-composition-api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-vue-3-0-中的-vue-composition-api"}},[t._v("#")]),t._v(" 5. Vue 3.0 中的 Vue Composition API？")]),t._v(" "),a("p",[t._v("2 中代码是 Options API 风格的，也就是通过填充 data、methods、computed 等属性来完成一个 Vue 组件。这种风格使得 Vue 极为容易上手，但：")]),t._v(" "),a("ul",[a("li",[t._v("不够灵活，使得开发缺乏优雅的方法来在组件间共用代码。")]),t._v(" "),a("li",[t._v("组件过于依赖"),a("code",[t._v("this")]),t._v("上下文，Vue 背后的一些小技巧使得 Vue 组件的开发看起来与 JS 开发原则相悖，比如在"),a("code",[t._v("methods")]),t._v(" 中的"),a("code",[t._v("this")]),t._v("竟然指向组件实例来不指向"),a("code",[t._v("methods")]),t._v("所在的对象。这也使得 TS 在2 中不好用。Composition API 使得 开发风格更接近于原生 JS 更多地灵活性")])]),t._v(" "),a("p",[t._v("Composition API 本质上是将 Options API 暴露给用户直接使用，拥有灵活性，拥抱TS。如：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("<template>\n  <button @click=\"increment\">\n    Count: {{ count }}\n  </button>\n</template>\n \n<script>\nimport { ref, computed, onMounted } from 'vue'\nexport default {\n  setup() {\n// 使用 ref 函数声明了称为 count 的响应属性，对应于Vue2中的data函数\n    const count = ref(0)\n// Vue2中需要在methods option中声明的函数，现在直接声明\n    function increment() {\n      count.value++\n    }\n // 对应于Vue2中的mounted声明周期\n    onMounted(() => console.log('component mounted!'))\n    return {\n      count,\n      increment\n    }\n  }\n}\n<\/script>\n")])])]),a("h2",{attrs:{id:"_6-composition-api与react-hook区别"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-composition-api与react-hook区别"}},[t._v("#")]),t._v(" 6. Composition API与React Hook区别")]),t._v(" "),a("p",[t._v("React Hook是根据useState调用的顺序来确定下一次重渲染时的state是来源于哪个useState，限制：")]),t._v(" "),a("ul",[a("li",[t._v("不能在循环、条件、嵌套函数中调用Hook")]),t._v(" "),a("li",[t._v("必须确保总是在React函数的顶层调用Hook")]),t._v(" "),a("li",[t._v("useEffect、useMemo等函数必须手动确定依赖关系")])]),t._v(" "),a("p",[t._v("Composition API：")]),t._v(" "),a("ul",[a("li",[t._v("声明在setup函数内，一次组件实例化只调用一次setup，而React Hook每次重渲染都需调用，使得React的GC比Vue更有压力，性能也较慢")]),t._v(" "),a("li",[t._v("Compositon API的调用不需要顾虑调用顺序，也可以在循环、条件、嵌套函数中使用")]),t._v(" "),a("li",[t._v("响应式系统自动实现依赖收集，进而组件的部分的性能优化由Vue内部自己完成，React Hook需手动传依赖，且必须必须保证依赖顺序，让useEffect、useMemo等函数正确捕获依赖变量，否则会由于依赖不正确使得组件性能下降。")])]),t._v(" "),a("p",[t._v("虽然Compositon API其设计思想也是借鉴React Hook的。")])])}),[],!1,null,null,null);s.default=e.exports}}]);